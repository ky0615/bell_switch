angular.module('application', [
  'ngRoute',
  'templates',
  'ui.bootstrap'
]).config([
  '$routeProvider',
  '$locationProvider',
  function ($routeProvider, $locationProvider) {
    $locationProvider.html5Mode(true);
    $routeProvider.when('/', {
      templateUrl: 'index.html',
      controller: 'IndexController'
    }).otherwise({
      templateUrl: 'error.html',
      controller: 'ErrorController'
    });
  }
]);
angular.module('application').run([
  '$httpBackend',
  function ($httpBackend) {
  }
]);
angular.module('application').directive('myHeader', function () {
  return {
    restrict: 'AE',
    templateUrl: 'parts/header.html'
  };
});
angular.module("templates", []).run(["$templateCache", function($templateCache) {$templateCache.put("index.html","<div id=\"main\" class=\"page-header\">\n  <div class=\"row\">\n    <header id=\"header\" class=\"\">\n      <h1>発車ベルスイッチ　コントロールパネル</h1>\n    </header>\n  </div>\n  <div class=\"row\">\n    <div class=\"col-md-6\">\n      <div class=\"bs-docs-section\">\n        <h1 class=\"page-header\">再生するメロディを選択</h1>\n        <div class=\"btn-group text-center\" role=\"group\">\n          <button type=\"button\" class=\"btn btn-default\" ng-click=\"reloadBellList()\">\n            <span class=\"glyphicon glyphicon-refresh\" aria-hidden=\"true\"></span>\n            更新\n          </button>\n          <button type=\"button\" class=\"btn btn-default\" ng-click=\"bellRandomSelect()\">\n            <span class=\"glyphicon glyphicon-random\" aria-hidden=\"true\"></span>\n            ランダム選曲\n          </button>\n        </div>\n      <p>選択中のメロディ: {{nowPlayingTitle}}</p>\n      </div>\n      <div class=\"list-group\">\n        <li class=\"list-group-item bell-list\" ng-repeat=\"(key, name) in bellFiles\" ng-click=\"setBell(key)\">\n          <span class=\"glyphicon\" ng-class=\"(nowBellId == key)?\'glyphicon-play-circle\': \'glyphicon-headphones\'\" aria-hidden=\"true\"></span>\n          {{name}}\n        </li>\n      </div>\n    </div>\n    <div class=\"col-md-6\">\n      <div class=\"bs-docs-section\">\n        <h1 class=\"page-header\">操作盤</h1>\n        <button type=\"button\" class=\"btn btn-primary\" ng-click=\"clickPlayBell()\">\n        <span class=\"glyphicon glyphicon-play\" aria-hidden=\"true\"></span>\n        メロディ再生\n        </button>\n        <button type=\"button\" class=\"btn btn-primary\" ng-click=\"clickStopBell()\">\n        <span class=\"glyphicon glyphicon-stop\" aria-hidden=\"true\"></span>\n        メロディ停止\n        </button>\n      </div>\n    </div>\n  </div>\n</div>");
$templateCache.put("parts/header.html","<div class=\"navbar navbar-default navbar-fixed-top\">\n  <div class=\"container\">\n    <div class=\"navbar-header\">\n      <h3>Bell Switch</h2>\n    </div>\n  </div>\n</div>");}]);
angular.module('application').controller('ErrorController', [
  '$rootScope',
  '$scope',
  function ($rootScope, $scope) {
  }
]);
angular.module('application').controller('IndexController', [
  '$rootScope',
  '$scope',
  function ($rootScope, $scope) {
  }
]);
angular.module('application').controller('MainController', [
  '$rootScope',
  '$scope',
  '$http',
  function ($rootScope, $scope, $http) {
    $scope.bellFiles = [];
    $scope.nowBellId = 0;
    $scope.nowPlayingTitle = '';
    $scope.setBell = function (key) {
      $scope.nowBellId = key;
      $scope.nowPlayingTitle = $scope.bellFiles[key];
      return $http.post('/setbellid', { id: key }).success(function (res, status) {
        return console.log(res);
      }).error(function (res, status) {
      });
    };
    $scope.getBellList = function () {
      return $http.get('/list').success(function (res, status) {
        return $scope.bellFiles = res;
      }).error(function (res, status) {
      });
    };
    $scope.getNowBellId = function () {
      return $http.get('/status').success(function (res, status) {
        $scope.nowBellId = res.bell_id;
        return $scope.nowPlayingTitle = $scope.bellFiles[$scope.nowBellId];
      }).error(function (res, status) {
      });
    };
    $scope.clickPlayBell = function () {
      return $http.get('/start').success(function (res, status) {
        return console.log(res);
      }).error(function (res, status) {
      });
    };
    $scope.clickStopBell = function () {
      return $http.get('/stop').success(function (res, status) {
        return console.log(res);
      }).error(function (res, status) {
      });
    };
    $scope.reloadBellList = function () {
      $scope.getBellList();
      return $scope.getNowBellId();
    };
    $scope.bellRandomSelect = function () {
      return $scope.setBell(Math.floor(Math.random() * $scope.bellFiles.length));
    };
    return $scope.reloadBellList();
  }
]);